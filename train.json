[
    {
        "prompt": "bar plot for top 5 batting average vs right arm medium fast bowlers who faced at least 1000 balls",
        "completion": "result=df1[(df1['bowling_style']=='RFM') & (df1['balls_faced']>1000)].sort_values(by='batting_average',ascending=False).head(5).plot(kind='bar',x='batsman',y='batting_average')"
    },
    {
        "prompt": "Top 10 batting average who played atleast 100 matches",
        "completion": "result=df3[(df3['matches_played']>=100)].sort_values(by='batting_average',ascending=False).head(10)"
    },
    {
        "prompt": "batting average of Virat Kohli",
        "completion": "result=df3[df3['batsman']=='Virat Kohli']['batting_average'].values[0]"
    },
    {
        "prompt": "bar plot of Top 10 batting strike rate who faced more than 1000 balls",
        "completion": "\nresult=df3[(df3['balls_faced']>1000)].sort_values(by='batting_strike_rate',ascending=False).head(10).plot(kind='bar',x='batsman',y='batting_strike_rate')\n"
    },
    {
        "prompt": "pie chart for all batting hands",
        "completion": "result=df1['bat_hand'].value_counts().plot(kind='pie')"
    },
    {
        "prompt": "5 right arm leg spin bowlers who has lowest economy against left hand batters who bowled more than 200 balls",
        "completion": "\nresult = df2[(df2['bowling_style'] == 'RWS') & (df2['bat_hand'] == 'LHB') & (df2['ball_bowled'] > 200)].sort_values(by='economy', ascending=True).head(5)\n"
    },
    {
        "prompt": "5 highest batting strike rate among batters who has 30+ batting average (faced at least 500 balls)",
        "completion": "result = df3[(df3['batting_average'] > 30) & (df3['balls_faced'] >= 500)].sort_values(by='batting_strike_rate', ascending=False).head(5)"
    },
    {
        "prompt": "plot to show 5 highest dot ball percent among right arm pacers",
        "completion": "result=df4[(df4['bowl_kind']=='pace bowler') & (df4['bowling_style']=='RM')].sort_values(by='dotballs_percent',ascending=False).head(5).plot(kind='bar',x='bowler',y='dotballs_percent')"
    },
    {
        "prompt": " plot to show 5 highest dot ball percent among right arm medium fast or right arm fast pacers who bowled more than 1000 balls",
        "completion": "result=df4[(df4['bowl_kind']=='pace bowler') & ((df4['bowling_style']=='RFM') | (df4['bowling_style']=='RF')) & (df4['ball_bowled']>1000)].sort_values(by='dotballs_percent',ascending=False).head(5).plot(kind='bar',x='bowler',y='dotballs_percent')"
    },
    {
        "prompt": "display pie chart of batters with average (less than 20, between 20 and 25, 25 and 30, 30 and 35, 35 and 40, 40 and above) among batters placed more than 300 balls",
        "completion": "\nbins=[0,20,25,30,35,40,45]\nlabels=['0-20','20-25','25-30','30-35','35-40','40+']\nresult=df3[(df3['balls_faced']>300)].groupby(pd.cut(df3['batting_average'],bins=bins,labels=labels))['batsman'].count().plot(kind='pie',title='Distribution of batting averages',autopct='%1.1f%%')\n"
    },
    {
        "prompt": "batsmen who have more 6s than 4s among those who faced 500+balls",
        "completion": "result=df3[(df3['balls_faced']>500) & (df3['6s']>df3['4s'])]"
    },
    {
        "prompt": "take ratio of 6s divided by 4s among batsmen who played 300+ balls. list top 5 players with highest ratio",
        "completion": "result = df3[(df3['balls_faced'] > 300)].assign(sixes_to_fours_ratio = lambda x: x['6s'] / x['4s']).sort_values(by = 'sixes_to_fours_ratio', ascending = False).head(5)"
    },
    {
        "prompt": "take ratio of 6s divided by 4s among batsmen who played 300+ balls. list top 5 players with highest ratio. show bar plot",
        "completion": "result=df3[(df3['balls_faced']>300)].assign(ratio_6s_4s=(df3['6s'] / df3['4s'])).sort_values(by='ratio_6s_4s',ascending=False).head(5).plot(kind='bar',x='batsman',y='ratio_6s_4s')"
    },
    {
        "prompt": "highest 5 strike rates of batsmen with boundary percent lesser than 50. criteria: faced 500+ balls. display bar plot",
        "completion": "result=df3[(df3['balls_faced']>500) & (df3['boundary_percent']<50)].sort_values(by='batting_strike_rate',ascending=False).head(5).plot(kind='bar',x='batsman',y='batting_strike_rate')"
    },
    {
        "prompt": "5 highest wicket takers among right arm leg spin bowlers who bowled 500+ balls",
        "completion": "result=df4[(df4['bowling_style']=='RWS') & (df4['bowl_kind']=='spin bowler') & (df4['ball_bowled']>500)].sort_values(by='dismissals',ascending=False).head(5)"
    },
    {
        "prompt": "5 highest wicket takers among right arm leg spin bowlers who bowled 500+ balls. display bar plot",
        "completion": "result=df4[(df4['bowling_style']=='RWS') & (df4['ball_bowled']>500)].sort_values(by='dismissals',ascending=False).head(5).plot(kind='bar',x='bowler',y='dismissals')"
    },
    {
        "prompt": "5 highest wicket takers among left arm fast bowlers who bowled 500+ balls. display bar plot",
        "completion": "result=df4[(df4['bowling_style']=='LF') & (df4['ball_bowled']>500)].sort_values(by='dismissals',ascending=False).head(5).plot(kind='bar',x='bowler',y='dismissals')"
    },
    {
        "prompt": "5 highest wicket takers among right arm fast or fast medium bowlers who bowled 500+ balls. display bar plot",
        "completion": "\nresult = df4[(df4['ball_bowled'] > 500) & ((df4['bowling_style'] == 'RF') | (df4['bowling_style'] == 'RFM'))].sort_values(by='dismissals', ascending=False).head(5).plot(kind='bar', x='bowler', y='dismissals')\n"
    },
    {
        "prompt": "pie chart among bowling kinds",
        "completion": "result=df4['bowl_kind'].value_counts().plot(kind='pie')"
    },
    {
        "prompt": "bar plot of top wicket takers among spin bowlers",
        "completion": "result=df4[(df4['bowl_kind']=='spin bowler')].sort_values(by='dismissals',ascending=False).head(10).plot(kind='bar',x='bowler',y='dismissals')"
    },
    {
        "prompt": "bar plot of top wicket takers among pace bowlers",
        "completion": "result=df4[(df4['bowl_kind']=='pace bowler')].sort_values(by='dismissals',ascending=False).head(5).plot(kind='bar',x='bowler',y='dismissals')"
    },
    {
        "prompt": "top 5 batting average among right handers, played 300+ balls, display bar plot",
        "completion": "result = df3[(df3['bat_hand'] == 'RHB') & (df3['balls_faced'] > 300)].sort_values(by='batting_average', ascending=False).head(5).plot(kind='bar', x='batsman', y='batting_average')"
    },
    {
        "prompt": "pie chart for all bowling types among spin bowlers, legends should be shown separately",
        "completion": "result=df1[df1['bowling_style'].isin(['OB','SLA','LWS','RWS','LSM'])].groupby('bowling_style')['bowling_style'].count().plot(kind='pie',title='Bowling types among spin bowlers',legend=True)"
    },
    {
        "prompt": "among pace bowlers, build a pie chart for all bowling types",
        "completion": "result=df4[df4['bowl_kind']=='pace bowler']['bowling_style'].value_counts().plot(kind='pie',title='Distribution of bowling types among pace bowlers')"
    },
    {
        "prompt": "among spin bowlers, build a pie chart for all bowling types, legends shown separately",
        "completion": "result=df1[df1['bowling_style'].str.contains('SLA|OB|LSM')]['bowling_style'].value_counts().plot(kind='pie',title='Distribution of bowling types among spin bowlers', legend=True)"
    }
]